<div align="center">

## –ú–∏–Ω–∏—Å—Ç–µ—Ä—Å—Ç–≤–æ –Ω–∞—É–∫–∏ –∏ –≤—ã—Å—à–µ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –†–æ—Å—Å–∏–π—Å–∫–æ–π –§–µ–¥–µ—Ä–∞—Ü–∏–∏
## –§–µ–¥–µ—Ä–∞–ª—å–Ω–æ–µ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–æ–µ –∞–≤—Ç–æ–Ω–æ–º–Ω–æ–µ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ —É—á—Ä–µ–∂–¥–µ–Ω–∏–µ –≤—ã—Å—à–µ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
## ¬´–ù–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –ò–¢–ú–û¬ª
## –§–∞–∫—É–ª—å—Ç–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–π –∏–Ω–∂–µ–Ω–µ—Ä–∏–∏ –∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–π —Ç–µ—Ö–Ω–∏–∫–∏
**–ö—É—Ä—Å–æ–≤–∞—è —Ä–∞–±–æ—Ç–∞ (—á–∞—Å—Ç—å 1)**

–ø–æ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–µ
"–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã"
</div>

<div align="right" style="margin-top: 50px;">
<b>–í—ã–ø–æ–ª–Ω–∏–ª–∏ —Å—Ç—É–¥–µ–Ω—Ç—ã –≥—Ä—É–ø–ø—ã P3312:</b>

–ü–∞—Ä—Ö–æ–º–µ–Ω–∫–æ –ö–∏—Ä–∏–ª–ª –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–∏—á
–°–æ–∫–æ–ª–æ–≤ –ê–Ω–∞—Ç–æ–ª–∏–π –í–ª–∞–¥–∏–º–∏—Ä–æ–≤–∏—á

<b>–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å:</b>
–ë–æ—Å—Ç—Ä–∏–∫–æ–≤–∞ –î–∞—Ä—å—è –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω–æ–≤–Ω–∞
</div>






<div align="center" style="margin-top: 200px; text: center">
–≥. –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥

2024–≥.
</div>

<div style="page-break-after: always;"></div>

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–í–≤–µ–¥–µ–Ω–∏–µ](#–≤–≤–µ–¥–µ–Ω–∏–µ)
- [–¢–∏–ø –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö](#—Ç–∏–ø-–±–∞–∑—ã-–¥–∞–Ω–Ω—ã—Ö)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-—Ç–∞–±–ª–∏—Ü)
  - [region](#region)
  - [apiary](#apiary)
  - [hive](#hive)
  - [bee_community](#bee_community)
  - [veterinary_passport](#veterinary_passport)
  - [veterinary_record](#veterinary_record)
  - [sensor](#sensor)
  - [sensor_reading](#sensor_reading)
  - [honey_harvest](#honey_harvest)
  - [observation_log](#observation_log)
  - [maintenance_plan](#maintenance_plan)
  - [incident](#incident)
  - [production_report](#production_report)
  - [weather_data](#weather_data)
  - [user](#user)
  - [allowed_regions](#allowed_regions)
  - [region_apiary](#region_apiary)
- [–°–≤—è–∑–∏](#—Å–≤—è–∑–∏)
- [–î–∏–∞–≥—Ä–∞–º–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö](#–¥–∏–∞–≥—Ä–∞–º–º–∞-–±–∞–∑—ã-–¥–∞–Ω–Ω—ã—Ö)

## –í–≤–µ–¥–µ–Ω–∏–µ

## –¢–∏–ø –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

- **–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö:** PostgreSQL

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü

### region

| –ù–∞–∑–≤–∞–Ω–∏–µ         | –¢–∏–ø          | –ù–∞—Å—Ç—Ä–æ–π–∫–∏       | –°—Å—ã–ª–∫–∏ | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
| ---------------- | ------------ | --------------- | ------ | ---------- |
| **region_id**    | SERIAL       | üîë PK, not null |        |            |
| **name**         | VARCHAR(100) | not null        |        |            |
| **climate_zone** | VARCHAR(50)  | not null        |        |            |

### apiary

| –ù–∞–∑–≤–∞–Ω–∏–µ               | –¢–∏–ø          | –ù–∞—Å—Ç—Ä–æ–π–∫–∏       | –°—Å—ã–ª–∫–∏ | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
| ---------------------- | ------------ | --------------- | ------ | ---------- |
| **apiary_id**          | SERIAL       | üîë PK, not null |        |            |
| **location**           | VARCHAR(255) | not null        |        |            |
| **manager_id**         | INTEGER      | not null        |        |            |
| **establishment_date** | DATE         | not null        |        |            |

### hive

| –ù–∞–∑–≤–∞–Ω–∏–µ              | –¢–∏–ø         | –ù–∞—Å—Ç—Ä–æ–π–∫–∏       | –°—Å—ã–ª–∫–∏             | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
| --------------------- | ----------- | --------------- | ------------------ | ---------- |
| **hive_id**           | SERIAL      | üîë PK, not null |                    |            |
| **apiary_id**         | INTEGER     | not null        | Hive_apiary_id_fk  |            |
| **hive_type**         | VARCHAR(50) | not null        |                    |            |
| **installation_date** | DATE        | not null        |                    |            |
| **current_status**    | VARCHAR(50) | not null        |                    |            |

### bee_community

| –ù–∞–∑–≤–∞–Ω–∏–µ                | –¢–∏–ø         | –ù–∞—Å—Ç—Ä–æ–π–∫–∏       | –°—Å—ã–ª–∫–∏                   | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
| ----------------------- | ----------- | --------------- | ------------------------ | ---------- |
| **community_id**        | SERIAL      | üîë PK, not null |                          |            |
| **hive_id**             | INTEGER     | not null        | BeeCommunity_hive_id_fk  |            |
| **queen_age**           | INTEGER     | not null        |                          |            |
| **population_estimate** | INTEGER     | not null        |                          |            |
| **health_status**       | VARCHAR(50) | not null        |                          |            |

### veterinary_passport

| –ù–∞–∑–≤–∞–Ω–∏–µ                 | –¢–∏–ø         | –ù–∞—Å—Ç—Ä–æ–π–∫–∏       | –°—Å—ã–ª–∫–∏                              | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
| ------------------------ | ----------- | --------------- | ----------------------------------- | ---------- |
| **passport_id**          | SERIAL      | üîë PK, not null |                                     |            |
| **community_id**         | INTEGER     | not null        | VeterinaryPassport_community_id_fk  |            |
| **issue_date**           | DATE        | not null        |                                     |            |
| **health_status**        | VARCHAR(50) | not null        |                                     |            |
| **last_inspection_date** | DATE        | not null        |                                     |            |

### veterinary_record

| –ù–∞–∑–≤–∞–Ω–∏–µ        | –¢–∏–ø     | –ù–∞—Å—Ç—Ä–æ–π–∫–∏       | –°—Å—ã–ª–∫–∏                           | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
| --------------- | ------- | --------------- | -------------------------------- | ---------- |
| **record_id**   | SERIAL  | üîë PK, not null |                                  |            |
| **passport_id** | INTEGER | not null        | VeterinaryRecord_passport_id_fk  |            |
| **record_date** | DATE    | not null        |                                  |            |
| **description** | TEXT    | not null        |                                  |            |
| **treatment**   | TEXT    | not null        |                                  |            |

### sensor

| –ù–∞–∑–≤–∞–Ω–∏–µ              | –¢–∏–ø         | –ù–∞—Å—Ç—Ä–æ–π–∫–∏       | –°—Å—ã–ª–∫–∏             | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
| --------------------- | ----------- | --------------- | ------------------ | ---------- |
| **sensor_id**         | SERIAL      | üîë PK, not null |                    |            |
| **hive_id**           | INTEGER     | not null        | Sensor_hive_id_fk  |            |
| **sensor_type**       | VARCHAR(50) | not null        |                    |            |
| **last_reading**      | BLOB        | not null        |                    |            |
| **last_reading_time** | TIMESTAMP   | not null        |                    |            |

### sensor_reading

| –ù–∞–∑–≤–∞–Ω–∏–µ       | –¢–∏–ø       | –ù–∞—Å—Ç—Ä–æ–π–∫–∏       | –°—Å—ã–ª–∫–∏                      | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
| -------------- | --------- | --------------- | --------------------------- | ---------- |
| **reading_id** | SERIAL    | üîë PK, not null |                             |            |
| **sensor_id**  | INTEGER   | not null        | SensorReading_sensor_id_fk  |            |
| **value**      | BLOB      | not null        |                             |            |
| **timestamp**  | TIMESTAMP | not null        |                             |            |

### honey_harvest

| –ù–∞–∑–≤–∞–Ω–∏–µ          | –¢–∏–ø         | –ù–∞—Å—Ç—Ä–æ–π–∫–∏       | –°—Å—ã–ª–∫–∏                   | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
| ----------------- | ----------- | --------------- | ------------------------ | ---------- |
| **harvest_id**    | SERIAL      | üîë PK, not null |                          |            |
| **hive_id**       | INTEGER     | not null        | HoneyHarvest_hive_id_fk  |            |
| **harvest_date**  | DATE        | not null        |                          |            |
| **quantity**      | BLOB        | not null        |                          |            |
| **quality_grade** | VARCHAR(50) | not null        |                          |            |

### observation_log

| –ù–∞–∑–≤–∞–Ω–∏–µ             | –¢–∏–ø     | –ù–∞—Å—Ç—Ä–æ–π–∫–∏       | –°—Å—ã–ª–∫–∏                     | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
| -------------------- | ------- | --------------- | -------------------------- | ---------- |
| **log_id**           | SERIAL  | üîë PK, not null |                            |            |
| **hive_id**          | INTEGER | not null        | ObservationLog_hive_id_fk  |            |
| **observation_date** | DATE    | not null        |                            |            |
| **description**      | TEXT    | not null        |                            |            |
| **recommendations**  | TEXT    | not null        |                            |            |

### maintenance_plan

| –ù–∞–∑–≤–∞–Ω–∏–µ         | –¢–∏–ø         | –ù–∞—Å—Ç—Ä–æ–π–∫–∏       | –°—Å—ã–ª–∫–∏                        | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
| ---------------- | ----------- | --------------- | ----------------------------- | ---------- |
| **plan_id**      | SERIAL      | üîë PK, not null |                               |            |
| **apiary_id**    | INTEGER     | not null        | MaintenancePlan_apiary_id_fk  |            |
| **planned_date** | DATE        | not null        |                               |            |
| **work_type**    | VARCHAR(50) | not null        |                               |            |
| **assigned_to**  | INTEGER     | not null        |                               |            |

### incident

| –ù–∞–∑–≤–∞–Ω–∏–µ          | –¢–∏–ø         | –ù–∞—Å—Ç—Ä–æ–π–∫–∏       | –°—Å—ã–ª–∫–∏               | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
| ----------------- | ----------- | --------------- | -------------------- | ---------- |
| **incident_id**   | SERIAL      | üîë PK, not null |                      |            |
| **hive_id**       | INTEGER     | not null        | Incident_hive_id_fk  |            |
| **incident_date** | DATE        | not null        |                      |            |
| **description**   | TEXT        | not null        |                      |            |
| **severity**      | VARCHAR(50) | not null        |                      |            |
| **actions_taken** | TEXT        | not null        |                      |            |

### production_report

| –ù–∞–∑–≤–∞–Ω–∏–µ                 | –¢–∏–ø     | –ù–∞—Å—Ç—Ä–æ–π–∫–∏       | –°—Å—ã–ª–∫–∏                         | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
| ------------------------ | ------- | --------------- | ------------------------------ | ---------- |
| **report_id**            | SERIAL  | üîë PK, not null |                                |            |
| **apiary_id**            | INTEGER | not null        | ProductionReport_apiary_id_fk  |            |
| **start_date**           | DATE    | not null        |                                |            |
| **end_date**             | DATE    | not null        |                                |            |
| **total_honey_produced** | BLOB    | not null        |                                |            |
| **total_expenses**       | BLOB    | not null        |                                |            |

### weather_data

| –ù–∞–∑–≤–∞–Ω–∏–µ          | –¢–∏–ø     | –ù–∞—Å—Ç—Ä–æ–π–∫–∏       | –°—Å—ã–ª–∫–∏                    | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
| ----------------- | ------- | --------------- | ------------------------- | ---------- |
| **weather_id**    | SERIAL  | üîë PK, not null |                           |            |
| **region_id**     | INTEGER | not null        | WeatherData_region_id_fk  |            |
| **date**          | DATE    | not null        |                           |            |
| **temperature**   | BLOB    | not null        |                           |            |
| **humidity**      | BLOB    | not null        |                           |            |
| **wind_speed**    | BLOB    | not null        |                           |            |
| **precipitation** | BLOB    | not null        |                           |            |

### user

| –ù–∞–∑–≤–∞–Ω–∏–µ       | –¢–∏–ø          | –ù–∞—Å—Ç—Ä–æ–π–∫–∏         | –°—Å—ã–ª–∫–∏           | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
| -------------- | ------------ | ------------------ | ---------------- | ---------- |
| **user_id**    | SERIAL       | üîë PK, not null    | User_user_id_fk  |            |
| **username**   | VARCHAR(50)  | not null , unique  |                  |            |
| **role**       | ROLE         | not null           |                  |            |
| **email**      | VARCHAR(100) | not null , unique  |                  |            |
| **last_login** | TIMESTAMP    | not null           |                  |            |

### allowed_regions

| –ù–∞–∑–≤–∞–Ω–∏–µ      | –¢–∏–ø     | –ù–∞—Å—Ç—Ä–æ–π–∫–∏                               | –°—Å—ã–ª–∫–∏                       | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
| ------------- | ------- | --------------------------------------- | ---------------------------- | ---------- |
| **id**        | INTEGER | üîë PK, not null , unique, autoincrement |                              |            |
| **user_id**   | INTEGER | not null                                |                              |            |
| **region_id** | INTEGER | not null                                | AllowedRegions_region_id_fk  |            |

### region_apiary

| –ù–∞–∑–≤–∞–Ω–∏–µ      | –¢–∏–ø     | –ù–∞—Å—Ç—Ä–æ–π–∫–∏                               | –°—Å—ã–ª–∫–∏                      | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
| ------------- | ------- | --------------------------------------- | --------------------------- | ---------- |
| **id**        | INTEGER | üîë PK, not null , unique, autoincrement |                             |            |
| **apiary_id** | INTEGER | not null                                | region_apiary_apiary_id_fk  |            |
| **region_id** | INTEGER | not null                                | region_apiary_region_id_fk  |            |

## –°–≤—è–∑–∏

- **hive –∫ apiary**: –º–Ω–æ–≥–∏–µ –∫ –æ–¥–Ω–æ–º—É
- **bee_community –∫ hive**: –º–Ω–æ–≥–∏–µ –∫ –æ–¥–Ω–æ–º—É
- **veterinary_passport –∫ bee_community**: –º–Ω–æ–≥–∏–µ –∫ –æ–¥–Ω–æ–º—É
- **veterinary_record –∫ veterinary_passport**: –º–Ω–æ–≥–∏–µ –∫ –æ–¥–Ω–æ–º—É
- **sensor –∫ hive**: –º–Ω–æ–≥–∏–µ –∫ –æ–¥–Ω–æ–º—É
- **sensor_reading –∫ sensor**: –º–Ω–æ–≥–∏–µ –∫ –æ–¥–Ω–æ–º—É
- **honey_harvest –∫ hive**: –º–Ω–æ–≥–∏–µ –∫ –æ–¥–Ω–æ–º—É
- **observation_log –∫ hive**: –º–Ω–æ–≥–∏–µ –∫ –æ–¥–Ω–æ–º—É
- **maintenance_plan –∫ apiary**: –º–Ω–æ–≥–∏–µ –∫ –æ–¥–Ω–æ–º—É
- **incident –∫ hive**: –º–Ω–æ–≥–∏–µ –∫ –æ–¥–Ω–æ–º—É
- **production_report –∫ apiary**: –º–Ω–æ–≥–∏–µ –∫ –æ–¥–Ω–æ–º—É
- **weather_data –∫ region**: –º–Ω–æ–≥–∏–µ –∫ –æ–¥–Ω–æ–º—É
- **user –∫ allowed_regions**: –æ–¥–∏–Ω –∫ –æ–¥–Ω–æ–º—É
- **allowed_regions –∫ region**: –æ–¥–∏–Ω –∫ –æ–¥–Ω–æ–º—É
- **region_apiary –∫ apiary**: –æ–¥–∏–Ω –∫ –æ–¥–Ω–æ–º—É
- **region_apiary –∫ region**: –æ–¥–∏–Ω –∫ –æ–¥–Ω–æ–º—É

## –î–∏–∞–≥—Ä–∞–º–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```mermaid
erDiagram
	hive ||--o{ apiary : —Å—Å—ã–ª–∞–µ—Ç—Å—è
	bee_community ||--o{ hive : —Å—Å—ã–ª–∞–µ—Ç—Å—è
	veterinary_passport ||--o{ bee_community : —Å—Å—ã–ª–∞–µ—Ç—Å—è
	veterinary_record ||--o{ veterinary_passport : —Å—Å—ã–ª–∞–µ—Ç—Å—è
	sensor ||--o{ hive : —Å—Å—ã–ª–∞–µ—Ç—Å—è
	sensor_reading ||--o{ sensor : —Å—Å—ã–ª–∞–µ—Ç—Å—è
	honey_harvest ||--o{ hive : —Å—Å—ã–ª–∞–µ—Ç—Å—è
	observation_log ||--o{ hive : —Å—Å—ã–ª–∞–µ—Ç—Å—è
	maintenance_plan ||--o{ apiary : —Å—Å—ã–ª–∞–µ—Ç—Å—è
	incident ||--o{ hive : —Å—Å—ã–ª–∞–µ—Ç—Å—è
	production_report ||--o{ apiary : —Å—Å—ã–ª–∞–µ—Ç—Å—è
	weather_data ||--o{ region : —Å—Å—ã–ª–∞–µ—Ç—Å—è
	user ||--|| allowed_regions : —Å—Å—ã–ª–∞–µ—Ç—Å—è
	allowed_regions ||--|| region : —Å—Å—ã–ª–∞–µ—Ç—Å—è
	region_apiary ||--|| apiary : —Å—Å—ã–ª–∞–µ—Ç—Å—è
	region_apiary ||--|| region : —Å—Å—ã–ª–∞–µ—Ç—Å—è

	region {
		SERIAL region_id
		VARCHAR(100) name
		VARCHAR(50) climate_zone
	}

	apiary {
		SERIAL apiary_id
		VARCHAR(255) location
		INTEGER manager_id
		DATE establishment_date
	}

	hive {
		SERIAL hive_id
		INTEGER apiary_id
		VARCHAR(50) hive_type
		DATE installation_date
		VARCHAR(50) current_status
	}

	bee_community {
		SERIAL community_id
		INTEGER hive_id
		INTEGER queen_age
		INTEGER population_estimate
		VARCHAR(50) health_status
	}

	veterinary_passport {
		SERIAL passport_id
		INTEGER community_id
		DATE issue_date
		VARCHAR(50) health_status
		DATE last_inspection_date
	}

	veterinary_record {
		SERIAL record_id
		INTEGER passport_id
		DATE record_date
		TEXT description
		TEXT treatment
	}

	sensor {
		SERIAL sensor_id
		INTEGER hive_id
		VARCHAR(50) sensor_type
		BLOB last_reading
		TIMESTAMP last_reading_time
	}

	sensor_reading {
		SERIAL reading_id
		INTEGER sensor_id
		BLOB value
		TIMESTAMP timestamp
	}

	honey_harvest {
		SERIAL harvest_id
		INTEGER hive_id
		DATE harvest_date
		BLOB quantity
		VARCHAR(50) quality_grade
	}

	observation_log {
		SERIAL log_id
		INTEGER hive_id
		DATE observation_date
		TEXT description
		TEXT recommendations
	}

	maintenance_plan {
		SERIAL plan_id
		INTEGER apiary_id
		DATE planned_date
		VARCHAR(50) work_type
		INTEGER assigned_to
	}

	incident {
		SERIAL incident_id
		INTEGER hive_id
		DATE incident_date
		TEXT description
		VARCHAR(50) severity
		TEXT actions_taken
	}

	production_report {
		SERIAL report_id
		INTEGER apiary_id
		DATE start_date
		DATE end_date
		BLOB total_honey_produced
		BLOB total_expenses
	}

	weather_data {
		SERIAL weather_id
		INTEGER region_id
		DATE date
		BLOB temperature
		BLOB humidity
		BLOB wind_speed
		BLOB precipitation
	}

	user {
		SERIAL user_id
		VARCHAR(50) username
		ROLE role
		VARCHAR(100) email
		TIMESTAMP last_login
	}

	allowed_regions {
		INTEGER id
		INTEGER user_id
		INTEGER region_id
	}

	region_apiary {
		INTEGER id
		INTEGER apiary_id
		INTEGER region_id
	}
```

## –°–∫—Ä–∏–ø—Ç—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### DDL (–Ø–∑—ã–∫ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö)

–§–∞–π–ª `ddl.sql` —Å–æ–¥–µ—Ä–∂–∏—Ç SQL-–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö. –û–Ω –≤–∫–ª—é—á–∞–µ—Ç:

1. –°–æ–∑–¥–∞–Ω–∏–µ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü, –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω—ã—Ö –≤ —Ä–∞–∑–¥–µ–ª–µ [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-—Ç–∞–±–ª–∏—Ü).
2. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–µ—Ä–≤–∏—á–Ω—ã—Ö –∫–ª—é—á–µ–π, –≤–Ω–µ—à–Ω–∏—Ö –∫–ª—é—á–µ–π –∏ –¥—Ä—É–≥–∏—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π.
3. –ù–∞—Å—Ç—Ä–æ–π–∫—É –ø–µ—Ä–µ—á–∏—Å–ª—è–µ–º—ã—Ö —Ç–∏–ø–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, ROLE –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã user).
4. –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π –¥–ª—è –ø–æ–ª–µ–π —Å –∞–≤—Ç–æ–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–æ–º.

–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–∏–ø SERIAL –¥–ª—è –ø–µ—Ä–≤–∏—á–Ω—ã—Ö –∫–ª—é—á–µ–π —Å –∞–≤—Ç–æ–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–æ–º.
- –†–µ–∞–ª–∏–∑—É–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è NOT NULL –¥–ª—è –≤–∞–∂–Ω—ã—Ö –ø–æ–ª–µ–π.
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å–≤—è–∑–∏ –≤–Ω–µ—à–Ω–∏—Ö –∫–ª—é—á–µ–π –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏.

```sql
-- Add constraints and checks

\c bee_management


ALTER TABLE Apiary ADD CONSTRAINT check_establishment_date CHECK (establishment_date <= CURRENT_DATE);
ALTER TABLE Hive ADD CONSTRAINT check_installation_date CHECK (installation_date <= CURRENT_DATE);
ALTER TABLE BeeCommunity ADD CONSTRAINT check_queen_age CHECK (queen_age >= 0);
ALTER TABLE BeeCommunity ADD CONSTRAINT check_population_estimate CHECK (population_estimate >= 0);
ALTER TABLE VeterinaryPassport ADD CONSTRAINT check_issue_date CHECK (issue_date <= CURRENT_DATE);
ALTER TABLE VeterinaryPassport ADD CONSTRAINT check_last_inspection_date CHECK (last_inspection_date <= CURRENT_DATE);
ALTER TABLE VeterinaryRecord ADD CONSTRAINT check_record_date CHECK (record_date <= CURRENT_DATE);
ALTER TABLE HoneyHarvest ADD CONSTRAINT check_harvest_date CHECK (harvest_date <= CURRENT_DATE);
ALTER TABLE HoneyHarvest ADD CONSTRAINT check_quantity CHECK (quantity >= 0);
ALTER TABLE ObservationLog ADD CONSTRAINT check_observation_date CHECK (observation_date <= CURRENT_DATE);
ALTER TABLE MaintenancePlan ADD CONSTRAINT check_planned_date CHECK (planned_date >= CURRENT_DATE);
ALTER TABLE Incident ADD CONSTRAINT check_incident_date CHECK (incident_date <= CURRENT_DATE);
ALTER TABLE ProductionReport ADD CONSTRAINT check_date_range CHECK (start_date <= end_date);
ALTER TABLE ProductionReport ADD CONSTRAINT check_total_honey_produced CHECK (total_honey_produced >= 0);
ALTER TABLE WeatherData ADD CONSTRAINT check_weather_date CHECK (date <= CURRENT_DATE);

```

### –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏ (populate.sql)

–°–∫—Ä–∏–ø—Ç `populate.sql` –∑–∞–ø–æ–ª–Ω—è–µ—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –Ω–∞—á–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏. –û–Ω –≤–∫–ª—é—á–∞–µ—Ç:

1. –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ INSERT –¥–ª—è –∫–∞–∂–¥–æ–π —Ç–∞–±–ª–∏—Ü—ã –≤ –ª–æ–≥–∏—á–µ—Å–∫–æ–º –ø–æ—Ä—è–¥–∫–µ –¥–ª—è —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–∏—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –≤–Ω–µ—à–Ω–∏—Ö –∫–ª—é—á–µ–π.
2. –ü—Ä–∏–º–µ—Ä—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è:
   - –†–µ–≥–∏–æ–Ω–æ–≤ –∏ –∫–ª–∏–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –∑–æ–Ω
   - –ü–∞—Å–µ–∫ –∏ –∏—Ö –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–π
   - –£–ª—å–µ–≤ –∏ –ø—á–µ–ª–∏–Ω—ã—Ö —Å–æ–æ–±—â–µ—Å—Ç–≤
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —Ä–∞–∑–Ω—ã–º–∏ —Ä–æ–ª—è–º–∏
   - –î–∞–Ω–Ω—ã—Ö –¥–∞—Ç—á–∏–∫–æ–≤ –∏ –ø–æ–∫–∞–∑–∞–Ω–∏–π
   - –ó–∞–ø–∏—Å–µ–π –æ —Å–±–æ—Ä–µ –º–µ–¥–∞
   - –ü–æ–≥–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
   - –ü–ª–∞–Ω–æ–≤ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –∏ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –Ω–∞–ª–∏—á–∏–µ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.


```sql
-- Connect to the database
\c bee_management

-- Function to populate the database with test data
CREATE OR REPLACE FUNCTION populate_test_data()
RETURNS VOID AS $$
BEGIN
    -- Insert test data for Region
    INSERT INTO Region (name, climate_zone) VALUES
    ('North', 'Temperate'),
    ('South', 'Mediterranean'),
    ('East', 'Continental'),
    ('West', 'Oceanic');

    -- Insert test data for Apiary
    INSERT INTO Apiary (location, establishment_date, region_id) VALUES
    ('Forest Edge', '2020-05-15', 1),
    ('Meadow', '2019-07-20', 2),
    ('Mountain Side', '2021-03-10', 3),
    ('Coastal Area', '2018-09-01', 4);

    -- Insert test data for Hive
    INSERT INTO Hive (apiary_id, installation_date) VALUES
    (1, '2020-06-01'),
    (1, '2020-06-02'),
    (2, '2019-08-01'),
    (3, '2021-04-01'),
    (4, '2018-10-01');

    -- Insert test data for BeeCommunity
    INSERT INTO BeeCommunity (hive_id, queen_age, population_estimate) VALUES
    (1, 2, 50000),
    (2, 1, 40000),
    (3, 3, 60000),
    (4, 1, 45000),
    (5, 2, 55000);

    -- Insert test data for User
    INSERT INTO "User" (username, password_hash, role) VALUES
    ('admin', 'hashed_password', 'admin'),
    ('user1', 'hashed_password', 'user'),
    ('user2', 'hashed_password', 'user');

    -- Insert test data for UserRegionAccess
    INSERT INTO UserRegionAccess (user_id, region_id) VALUES
    (2, 1),
    (2, 2),
    (3, 3),
    (3, 4);

    -- Insert test data for HoneyHarvest
    INSERT INTO HoneyHarvest (hive_id, harvest_date, quantity) VALUES
    (1, '2021-08-15', 25.5),
    (2, '2021-08-16', 22.0),
    (3, '2021-08-20', 30.5),
    (4, '2021-09-01', 28.0),
    (5, '2021-09-05', 26.5);

    -- Insert test data for ObservationLog
    INSERT INTO ObservationLog (hive_id, user_id, observation_date, notes) VALUES
    (1, 2, '2021-07-01', 'Bees appear healthy and active'),
    (2, 2, '2021-07-02', 'Queen spotted, laying eggs'),
    (3, 3, '2021-07-10', 'Hive population growing steadily'),
    (4, 3, '2021-07-15', 'Some signs of possible mite infestation'),
    (5, 2, '2021-07-20', 'Honey production looks promising');

    -- Insert test data for MaintenancePlan
    INSERT INTO MaintenancePlan (hive_id, planned_date, description) VALUES
    (1, '2021-10-01', 'Winter preparation'),
    (2, '2021-10-02', 'Winter preparation'),
    (3, '2021-10-05', 'Winter preparation'),
    (4, '2021-10-10', 'Mite treatment'),
    (5, '2021-10-15', 'Winter preparation');

    -- Insert test data for Incident
    INSERT INTO Incident (hive_id, incident_date, description) VALUES
    (4, '2021-07-20', 'Mite infestation detected');

    -- Insert test data for WeatherData
    INSERT INTO WeatherData (region_id, date, temperature, humidity, precipitation) VALUES
    (1, '2021-08-01', 25.5, 60.0, 0.0),
    (2, '2021-08-01', 28.0, 55.0, 0.0),
    (3, '2021-08-01', 23.0, 65.0, 5.0),
    (4, '2021-08-01', 22.0, 70.0, 2.0);

END;
$$ LANGUAGE plpgsql;

-- Execute the function to populate the database
SELECT populate_test_data();

-- Confirm population
SELECT 'Test data inserted successfully!' AS result;
```

### –¢—Ä–∏–≥–≥–µ—Ä—ã (trigger.sql)

–§–∞–π–ª `trigger.sql` –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤:

1. `update_last_reading_trigger`: –û–±–Ω–æ–≤–ª—è–µ—Ç `last_reading` –∏ `last_reading_time` –≤ —Ç–∞–±–ª–∏—Ü–µ `sensor` –ø—Ä–∏ –≤—Å—Ç–∞–≤–∫–µ –Ω–æ–≤–æ–≥–æ –ø–æ–∫–∞–∑–∞–Ω–∏—è –¥–∞—Ç—á–∏–∫–∞.

2. `update_hive_status_trigger`: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç `current_status` —É–ª—å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ø–æ–∫–∞–∑–∞–Ω–∏–π –¥–∞—Ç—á–∏–∫–æ–≤ –∏ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤.

3. `log_user_login_trigger`: –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—É—é –º–µ—Ç–∫—É `last_login` –≤ —Ç–∞–±–ª–∏—Ü–µ `user` –ø—Ä–∏ –∫–∞–∂–¥–æ–º –≤—Ö–æ–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å–∏—Å—Ç–µ–º—É.

4. `validate_harvest_quantity_trigger`: –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç, —á—Ç–æ–±—ã –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–±—Ä–∞–Ω–Ω–æ–≥–æ –º–µ–¥–∞ –Ω–∞—Ö–æ–¥–∏–ª–æ—Å—å –≤ —Ä–∞–∑—É–º–Ω—ã—Ö –ø—Ä–µ–¥–µ–ª–∞—Ö –ø–µ—Ä–µ–¥ –≤—Å—Ç–∞–≤–∫–æ–π.

5. `update_community_health_trigger`: –û–±–Ω–æ–≤–ª—è–µ—Ç `health_status` –ø—á–µ–ª–∏–Ω–æ–≥–æ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –≤–µ—Ç–µ—Ä–∏–Ω–∞—Ä–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π.

–≠—Ç–∏ —Ç—Ä–∏–≥–≥–µ—Ä—ã –ø–æ–º–æ–≥–∞—é—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä—É—Ç–∏–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö.

```sql
-- Create triggers

\c bee_management

CREATE OR REPLACE FUNCTION update_last_login()
RETURNS TRIGGER AS $$
BEGIN
    NEW.last_login = CURRENT_TIMESTAMP;
    RETURN NEW;
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER update_user_last_login
BEFORE UPDATE ON "User"
FOR EACH ROW
EXECUTE FUNCTION update_last_login();

-- Create a function to grant access to all regions for admin users
CREATE OR REPLACE FUNCTION grant_admin_access()
RETURNS TRIGGER AS $$
BEGIN
    IF NEW.role = 'admin' THEN
        INSERT INTO UserRegionAccess (user_id, region_id)
        SELECT NEW.id, r.id
        FROM Region r
        ON CONFLICT (user_id, region_id) DO NOTHING;
    END IF;
    RETURN NEW;
END;
$$ LANGUAGE plpgsql;

-- Create a trigger to automatically grant access to all regions for admin users
CREATE TRIGGER admin_access_trigger
AFTER INSERT OR UPDATE ON "User"
FOR EACH ROW
EXECUTE FUNCTION grant_admin_access();

CREATE OR REPLACE FUNCTION update_population_estimate()
RETURNS TRIGGER AS $$
BEGIN
    IF TG_OP = 'INSERT' THEN
        UPDATE BeeCommunity
        SET population_estimate = population_estimate + NEW.quantity
        WHERE id = NEW.bee_community_id;
    ELSIF TG_OP = 'DELETE' THEN
        UPDATE BeeCommunity
        SET population_estimate = population_estimate - OLD.quantity
        WHERE id = OLD.bee_community_id;
    END IF;
    RETURN NULL;
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER update_bee_population
AFTER INSERT OR DELETE ON HoneyHarvest
FOR EACH ROW
EXECUTE FUNCTION update_population_estimate();

-- Trigger to automatically create a veterinary passport for new bee communities
CREATE OR REPLACE FUNCTION create_veterinary_passport()
RETURNS TRIGGER AS $$
BEGIN
    INSERT INTO VeterinaryPassport (bee_community_id, issue_date, last_inspection_date)
    VALUES (NEW.id, CURRENT_DATE, CURRENT_DATE);
    RETURN NEW;
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER new_bee_community_passport
AFTER INSERT ON BeeCommunity
FOR EACH ROW
EXECUTE FUNCTION create_veterinary_passport();

-- Trigger to update production report when new honey harvest is added
CREATE OR REPLACE FUNCTION update_production_report()
RETURNS TRIGGER AS $$
BEGIN
    INSERT INTO ProductionReport (apiary_id, start_date, end_date, total_honey_produced)
    VALUES (
        (SELECT apiary_id FROM Hive WHERE id = NEW.hive_id),
        DATE_TRUNC('month', NEW.harvest_date),
        DATE_TRUNC('month', NEW.harvest_date) + INTERVAL '1 month' - INTERVAL '1 day',
        NEW.quantity
    )
    ON CONFLICT (apiary_id, start_date, end_date)
    DO UPDATE SET total_honey_produced = ProductionReport.total_honey_produced + NEW.quantity;
    RETURN NEW;
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER update_honey_production
AFTER INSERT ON HoneyHarvest
FOR EACH ROW
EXECUTE FUNCTION update_production_report();
```

### –ò–Ω–¥–µ–∫—Å—ã (indexes.sql)

–°–∫—Ä–∏–ø—Ç `indexes.sql` —Å–æ–∑–¥–∞–µ—Ç –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∑–∞–ø—Ä–æ—Å–æ–≤:

1. `idx_hive_apiary`: –ò–Ω–¥–µ–∫—Å –ø–æ `apiary_id` –≤ —Ç–∞–±–ª–∏—Ü–µ `hive` –¥–ª—è –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π —Å —Ç–∞–±–ª–∏—Ü–µ–π `apiary`.

2. `idx_sensor_reading_timestamp`: –ò–Ω–¥–µ–∫—Å –ø–æ `timestamp` –≤ —Ç–∞–±–ª–∏—Ü–µ `sensor_reading` –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—Ä–µ–º–µ–Ω–∏.

3. `idx_honey_harvest_date`: –°–æ—Å—Ç–∞–≤–Ω–æ–π –∏–Ω–¥–µ–∫—Å –ø–æ `hive_id` –∏ `harvest_date` –≤ —Ç–∞–±–ª–∏—Ü–µ `honey_harvest` –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –æ—Ç—á–µ—Ç–æ–≤ –æ —Å–±–æ—Ä–µ –º–µ–¥–∞.

4. `idx_weather_data_region_date`: –°–æ—Å—Ç–∞–≤–Ω–æ–π –∏–Ω–¥–µ–∫—Å –ø–æ `region_id` –∏ `date` –≤ —Ç–∞–±–ª–∏—Ü–µ `weather_data` –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø–æ–≥–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

5. `idx_user_username`: –ò–Ω–¥–µ–∫—Å –ø–æ `username` –≤ —Ç–∞–±–ª–∏—Ü–µ `user` –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

–≠—Ç–∏ –∏–Ω–¥–µ–∫—Å—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω—ã –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–∏—Å—Ç–µ–º–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—á–µ–ª–æ–≤–æ–¥—Å—Ç–≤–æ–º.

```sql
-- Add indexes for performance

\c bee_management

CREATE INDEX idx_apiary_region ON Apiary(region_id);
CREATE INDEX idx_hive_apiary ON Hive(apiary_id);
CREATE INDEX idx_bee_community_hive ON BeeCommunity(hive_id);
CREATE INDEX idx_user_region_access_user ON UserRegionAccess(user_id);
CREATE INDEX idx_user_region_access_region ON UserRegionAccess(region_id);
CREATE INDEX idx_veterinary_passport_bee_community ON VeterinaryPassport(bee_community_id);
CREATE INDEX idx_veterinary_record_passport ON VeterinaryRecord(passport_id);
CREATE INDEX idx_honey_harvest_hive ON HoneyHarvest(hive_id);
CREATE INDEX idx_observation_log_hive ON ObservationLog(hive_id);
CREATE INDEX idx_observation_log_user ON ObservationLog(user_id);
CREATE INDEX idx_maintenance_plan_hive ON MaintenancePlan(hive_id);
CREATE INDEX idx_incident_hive ON Incident(hive_id);
CREATE INDEX idx_production_report_apiary ON ProductionReport(apiary_id);
CREATE INDEX idx_weather_data_region ON WeatherData(region_id);
```

### –§—É–Ω–∫—Ü–∏–∏ (functions.sql)

–§–∞–π–ª `functions.sql` –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–ª–µ–∑–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

1. `calculate_average_honey_yield(hive_id INT, start_date DATE, end_date DATE) RETURNS DECIMAL`:
   –í—ã—á–∏—Å–ª—è–µ—Ç —Å—Ä–µ–¥–Ω–∏–π –≤—ã—Ö–æ–¥ –º–µ–¥–∞ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —É–ª—å—è –∑–∞ –∑–∞–¥–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥ –≤—Ä–µ–º–µ–Ω–∏.

2. `get_hive_health_status(hive_id INT) RETURNS VARCHAR`:
   –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –æ–±—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–¥–æ—Ä–æ–≤—å—è —É–ª—å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ø–æ–∫–∞–∑–∞–Ω–∏–π –¥–∞—Ç—á–∏–∫–æ–≤ –∏ –≤–µ—Ç–µ—Ä–∏–Ω–∞—Ä–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π.

3. `find_optimal_harvest_time(apiary_id INT) RETURNS DATE`:
   –ü—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –¥–ª—è —Å–±–æ—Ä–∞ –º–µ–¥–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–≥–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è —É–ª—å–µ–≤.

4. `calculate_apiary_productivity(apiary_id INT, year INT) RETURNS DECIMAL`:
   –í—ã—á–∏—Å–ª—è–µ—Ç –æ–±—â—É—é –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–∞—Å–µ–∫–∏ –∑–∞ –¥–∞–Ω–Ω—ã–π –≥–æ–¥, —É—á–∏—Ç—ã–≤–∞—è –≤—ã—Ö–æ–¥ –º–µ–¥–∞ –∏ —Ä–∞—Å—Ö–æ–¥—ã.

5. `generate_maintenance_report(apiary_id INT) RETURNS TABLE`:
   –°–æ–∑–¥–∞–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –æ—Ç—á–µ—Ç –æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–º –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–∏ –ø–∞—Å–µ–∫–∏, –≤–∫–ª—é—á–∞—è –ø—Ä–µ–¥—Å—Ç–æ—è—â–∏–µ –∑–∞–¥–∞—á–∏ –∏ –Ω–µ–¥–∞–≤–Ω–∏–µ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã.

–≠—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–Ω–∫–∞–ø—Å—É–ª–∏—Ä—É—é—Ç —Å–ª–æ–∂–Ω—É—é –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø—á–µ–ª–æ–≤–æ–¥—Å—Ç–≤–∞.

```sql
-- 1. –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –º–µ–¥–∞, —Å–æ–±—Ä–∞–Ω–Ω–æ–≥–æ –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º —É–ª—å–µ –∑–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥
CREATE OR REPLACE FUNCTION get_total_honey_harvested(
    p_hive_id INTEGER,
    p_start_date DATE,
    p_end_date DATE
) RETURNS DECIMAL AS $$
DECLARE
    total_honey DECIMAL;
BEGIN
    SELECT COALESCE(SUM(quantity::DECIMAL), 0)
    INTO total_honey
    FROM honey_harvest
    WHERE hive_id = p_hive_id
    AND harvest_date BETWEEN p_start_date AND p_end_date;

    RETURN total_honey;
END;
$$ LANGUAGE plpgsql;

-- 2. –ü—Ä–æ—Ü–µ–¥—É—Ä–∞ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –≤ –∂—É—Ä–Ω–∞–ª
CREATE OR REPLACE PROCEDURE add_observation(
    p_hive_id INTEGER,
    p_observation_date DATE,
    p_description TEXT,
    p_recommendations TEXT
) AS $$
BEGIN
    INSERT INTO observation_log (hive_id, observation_date, description, recommendations)
    VALUES (p_hive_id, p_observation_date, p_description, p_recommendations);
END;
$$ LANGUAGE plpgsql;

-- 3. –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∑–¥–æ—Ä–æ–≤—å—è –ø—á–µ–ª–∏–Ω–æ–π –æ–±—â–∏–Ω—ã
CREATE OR REPLACE FUNCTION get_community_health_status(p_community_id INTEGER)
RETURNS VARCHAR AS $$
DECLARE
    health_status VARCHAR;
BEGIN
    SELECT vp.health_status
    INTO health_status
    FROM veterinary_passport vp
    WHERE vp.community_id = p_community_id
    ORDER BY vp.last_inspection_date DESC
    LIMIT 1;

    RETURN COALESCE(health_status, 'Unknown');
END;
$$ LANGUAGE plpgsql;

-- 4. –ü—Ä–æ—Ü–µ–¥—É—Ä–∞ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ —É–ª—å—è
CREATE OR REPLACE PROCEDURE update_hive_status(
    p_hive_id INTEGER,
    p_new_status VARCHAR
) AS $$
BEGIN
    UPDATE hive
    SET current_status = p_new_status
    WHERE hive_id = p_hive_id;
END;
$$ LANGUAGE plpgsql;

-- 5. –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Å—Ä–µ–¥–Ω–µ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –≤ —Ä–µ–≥–∏–æ–Ω–µ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ N –¥–Ω–µ–π
CREATE OR REPLACE FUNCTION get_avg_temperature(
    p_region_id INTEGER,
    p_days INTEGER
) RETURNS DECIMAL AS $$
DECLARE
    avg_temp DECIMAL;
BEGIN
    SELECT AVG(temperature::DECIMAL)
    INTO avg_temp
    FROM weather_data
    WHERE region_id = p_region_id
    AND date >= CURRENT_DATE - p_days;

    RETURN COALESCE(avg_temp, 0);
END;
$$ LANGUAGE plpgsql;

-- 6. –ü—Ä–æ—Ü–µ–¥—É—Ä–∞ –¥–ª—è –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è —Ä–∞–±–æ—Ç–Ω–∏–∫–∞ –Ω–∞ –ø–ª–∞–Ω –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è
CREATE OR REPLACE PROCEDURE assign_maintenance_plan(
    p_plan_id INTEGER,
    p_user_id INTEGER
) AS $$
BEGIN
    UPDATE maintenance_plan
    SET assigned_to = p_user_id
    WHERE plan_id = p_plan_id;
END;
$$ LANGUAGE plpgsql;

-- 7. –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫ —Ä–µ–≥–∏–æ–Ω—É
CREATE OR REPLACE FUNCTION has_region_access(
    p_user_id INTEGER,
    p_region_id INTEGER
) RETURNS BOOLEAN AS $$
DECLARE
    has_access BOOLEAN;
BEGIN
    SELECT EXISTS (
        SELECT 1
        FROM allowed_regions
        WHERE user_id = p_user_id AND region_id = p_region_id
    ) INTO has_access;

    RETURN has_access;
END;
$$ LANGUAGE plpgsql;

-- 8. –ü—Ä–æ—Ü–µ–¥—É—Ä–∞ –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞
CREATE OR REPLACE PROCEDURE register_incident(
    p_hive_id INTEGER,
    p_incident_date DATE,
    p_description TEXT,
    p_severity VARCHAR
) AS $$
BEGIN
    INSERT INTO incident (hive_id, incident_date, description, severity)
    VALUES (p_hive_id, p_incident_date, p_description, p_severity);
END;
$$ LANGUAGE plpgsql;

-- 9. –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ø–æ–∫–∞–∑–∞–Ω–∏–π –¥–∞—Ç—á–∏–∫–∞
CREATE OR REPLACE FUNCTION get_latest_sensor_reading(p_hive_id INTEGER, p_sensor_type VARCHAR)
RETURNS TABLE (value BYTEA, timestamp TIMESTAMP) AS $$
BEGIN
    RETURN QUERY
    SELECT sr.value, sr.timestamp
    FROM sensor s
    JOIN sensor_reading sr ON s.sensor_id = sr.sensor_id
    WHERE s.hive_id = p_hive_id AND s.sensor_type = p_sensor_type
    ORDER BY sr.timestamp DESC
    LIMIT 1;
END;
$$ LANGUAGE plpgsql;

-- 10. –ü—Ä–æ—Ü–µ–¥—É—Ä–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç—á–µ—Ç–∞ –æ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ
CREATE OR REPLACE PROCEDURE create_production_report(
    p_apiary_id INTEGER,
    p_start_date DATE,
    p_end_date DATE
) AS $$
DECLARE
    total_honey DECIMAL;
    total_expenses DECIMAL;
BEGIN
    -- –†–∞—Å—á–µ—Ç –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–æ–±—Ä–∞–Ω–Ω–æ–≥–æ –º–µ–¥–∞
    SELECT COALESCE(SUM(quantity::DECIMAL), 0)
    INTO total_honey
    FROM honey_harvest hh
    JOIN hive h ON hh.hive_id = h.hive_id
    WHERE h.apiary_id = p_apiary_id
    AND hh.harvest_date BETWEEN p_start_date AND p_end_date;

    -- –ó–¥–µ—Å—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ä–∞—Å—á–µ—Ç –æ–±—â–∏—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤ (–ø—Ä–∏–º–µ—Ä)
    total_expenses := 1000.00;

    -- –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–∞
    INSERT INTO production_report (apiary_id, start_date, end_date, total_honey_produced, total_expenses)
    VALUES (p_apiary_id, p_start_date, p_end_date, total_honey, total_expenses);
END;
$$ LANGUAGE plpgsql;
```

## –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

–î–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:

1. –í—ã–ø–æ–ª–Ω–∏—Ç–µ `ddl.sql` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `indexes.sql` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏–Ω–¥–µ–∫—Å–æ–≤, –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É—é—â–∏—Ö –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å.
3. –ü—Ä–∏–º–µ–Ω–∏—Ç–µ `trigger.sql` –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã–º–∏.
4. –í—ã–ø–æ–ª–Ω–∏—Ç–µ `functions.sql` –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∏ —Å–ª—É–∂–µ–±–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π.
5. –ù–∞–∫–æ–Ω–µ—Ü, –∑–∞–ø—É—Å—Ç–∏—Ç–µ `populate.sql` –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö.

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –≤—ã–ø–æ–ª–Ω—è–µ—Ç–µ —ç—Ç–∏ —Å–∫—Ä–∏–ø—Ç—ã –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ø—Ä–æ–±–ª–µ–º —Å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏.

## –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

–ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:

1. –ò–∑–º–µ–Ω–∏—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ SQL-—Ñ–∞–π–ª—ã –ø–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.
2. –û–±–Ω–æ–≤–∏—Ç–µ `populate.sql`, –µ—Å–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—é—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–∏–º–µ—Ä–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
3. –ü–æ—Å–ª–µ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ä–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–µ—Ä–µ—Å—Ç—Ä–æ–µ–Ω–∏—è –∏–Ω–¥–µ–∫—Å–æ–≤ –¥–ª—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.
4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≤—Å–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã –∏ —Ñ—É–Ω–∫—Ü–∏–∏, —á—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –æ–Ω–∏ –æ—Å—Ç–∞—é—Ç—Å—è —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–º–∏ —Å –ª—é–±—ã–º–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏.
5. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ —ç—Ç—É –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –≤ –∞–∫—Ç—É–∞–ª—å–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏, –æ—Ç—Ä–∞–∂–∞—è –≤—Å–µ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏.
